{{ define "main" }}

    <svg xmlns="http://www.w3.org/2000/svg" width="0" height="0">
        <filter id="noise" x="0%" y="0%" width="100%" height="100%" filterUnits="userSpaceOnUse">
            <feTurbulence baseFrequency="0.1 0.2" result="f1" numOctaves="3" />
            <feDisplacementMap in="SourceGraphic" in2="f1" scale="8"></feDisplacementMap>
        </filter>
        <filter id="waves" x="0%" y="0%" width="100%" height="100%" filterUnits="userSpaceOnUse">
            <feTurbulence baseFrequency="0.02 0.08" result="f1" numOctaves="3" />
            <feDisplacementMap in="SourceGraphic" in2="f1" scale="20"></feDisplacementMap>
        </filter>
        <filter id="noise2" x="0%" y="0%" width="100%" height="100%" filterUnits="userSpaceOnUse">
            <feTurbulence baseFrequency="0.01 0.01" result="f1" numOctaves="3" />
            <feDisplacementMap in="SourceGraphic" in2="f1" scale="100"></feDisplacementMap>
        </filter>
        <filter id="roughpaper" x="0%" y="0%" width="100%" height="100%">

            <feTurbulence type="fractalNoise" baseFrequency="0.1" result="f1" numOctaves="5" />

            <feDiffuseLighting in="f1" lighting-color="white" result="f2" surfaceScale="5">
                <feDistantLight azimuth="45" elevation="90" />
            </feDiffuseLighting>

            <feComposite in="f2" in2="SourceGraphic" result="f3" operator="in" />

            <feBlend in="f3" in2="SourceGraphic" mode="multiply" />

        </filter>
    </svg>

    <div class="gallery">

        <div class="gallery__item gallery__item--meta">
            <header class="gallery__header">
                <h1 class="gallery__heading">{{ .Title }}</h1>
                <p class="gallery__desc">{{ .RawContent }}</p>
            </header>
        </div>

        {{ range $index, $image := union (.Resources.Match "thumb") (.Resources.Match "img/*") }}
            {{ $is_large_thumb := eq (mod $index 6) 0 }}
            {{ $thumb := cond $is_large_thumb ($image.Resize "1600x q75") ($image.Resize "800x q75") }}
            {{ $is_vertical := gt $image.Height $image.Width }}
            <div class="gallery__item {{ if $is_vertical }}gallery__item--vertical{{ end }}">
                <a class="gallery__image-container" href="{{ $image.Permalink }}">
                    <img class="gallery__image" src="{{ $thumb.Permalink }}">
                </a>
            </div>
        {{ end }}

        <div class="gallery__item gallery__item--meta">
            <footer class="gallery__footer">
                <p class="gallery__license">Všechny fotografie jsou chráněny autorským zákonem a licencí <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.cs">CC BY-NC-SA 4.0</a>. V případě, že chcete fotografie použít nad rámec licence, neváhejte mi <a href="mailto:adam.havel@protonmail.com">napsat</a>.</p>
            </footer>
        </div>

    </div>

{{ end }}